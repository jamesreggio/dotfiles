---
- hosts: all
  vars:
    base: "{{ inventory_dir }}"
    home: "{{ lookup('env', 'HOME') }}"
    user: "{{ lookup('env', 'USER') }}"

    taps: []

    brews:
      - ansible
      - bat
      - cloc
      - colordiff
      - exiftool
      - fasd
      - fnm
      - git
      - httpie
      - jq
      - neovim
      - postgresql@14
      - ripgrep
      - tree
      - vim
      - wget

    casks:
      - arc
      # Broken package
      # - copyclip
      - descript
      - figma
      - font-inconsolata-g
      - granola
      - graphiql
      - iterm2
      - itermai
      - linear-linear
      - logitune
      - loom
      - notion-calendar
      - screen-studio
      - signal
      - slack
      - superwhisper
      - vscodium
      - whatsapp

    files:
      bin: bin
      gitconfig:
      gitignore:
      iterm2:
      vim:
      vimrc:
      vscode.json: Library/Application Support/Code/User/settings.json
      zprofile:
      zsh_aliases:
      zshrc:

    visibility:
      bin: hidden
      src: hidden

    preferences:
      - defaults write -g ApplePressAndHoldEnabled -bool false
      - defaults write "com.apple.terminal" "Default Window Settings" -string "base16-tomorrow"
      - defaults write "com.apple.terminal" "Startup Window Settings" -string "base16-tomorrow"
      - defaults write "com.apple.terminal" "Window Settings" -dict-add "base16-tomorrow" "$(cat {{ base }}/preferences/base16-tomorrow.plist)"
      - defaults write "com.googlecode.iterm2" LoadPrefsFromCustomFolder -bool true
      - defaults write "com.googlecode.iterm2" PrefsCustomFolder "{{ home }}/.iterm2"

  tasks:
    - name: Import Homebrew tasks
      import_tasks: tasks/homebrew.yml

    - name: Import file management tasks
      import_tasks: tasks/files.yml

    - name: Import Vim setup tasks
      import_tasks: tasks/vim.yml

    - name: Import preference configuration tasks
      import_tasks: tasks/preferences.yml
      when: lookup('env', 'PREFS') != '0'
